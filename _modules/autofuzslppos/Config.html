

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>autofuzslppos.Config &mdash; AutoFuzSlpPos 1.1.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="AutoFuzSlpPos 1.1.1 documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> AutoFuzSlpPos
          

          
          </a>

          
            
            
              <div class="version">
                1.1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../config.html">Configuration</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">AutoFuzSlpPos</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>autofuzslppos.Config</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for autofuzslppos.Config</h1><div class="highlight"><pre>
<span></span><span class="ch">#! /usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;Configuration of pyAutoFuzSlpPos project.</span>

<span class="sd">    @author: Liangjun Zhu</span>

<span class="sd">    @changelog:</span>
<span class="sd">    - 15-07-31  lj - initial implementation.</span>
<span class="sd">    - 17-07-31  lj - reorganize as basic class, and incorporated with pygeoc.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">unicode_literals</span><span class="p">,</span> <span class="n">division</span>

<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="k">import</span> <span class="n">cpu_count</span>
<span class="kn">from</span> <span class="nn">configparser</span> <span class="k">import</span> <span class="n">ConfigParser</span>

<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;..&#39;</span><span class="p">))</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;..&#39;</span><span class="p">)))</span>

<span class="kn">from</span> <span class="nn">pygeoc.utils</span> <span class="k">import</span> <span class="n">FileClass</span><span class="p">,</span> <span class="n">StringClass</span>

<span class="kn">from</span> <span class="nn">autofuzslppos.Nomenclature</span> <span class="k">import</span> <span class="n">CreateWorkspace</span><span class="p">,</span> <span class="n">PreProcessAttrNames</span><span class="p">,</span> <span class="n">TopoAttrNames</span><span class="p">,</span> \
    <span class="n">LogNames</span><span class="p">,</span> <span class="n">FuzSlpPosFiles</span><span class="p">,</span> <span class="n">SingleSlpPosFiles</span>


<div class="viewcode-block" id="AutoFuzSlpPosConfig"><a class="viewcode-back" href="../../config.html#autofuzslppos.Config.AutoFuzSlpPosConfig">[docs]</a><span class="k">class</span> <span class="nc">AutoFuzSlpPosConfig</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get input arguments for pyAutoFuzSlpPos main program and</span>
<span class="sd">       parse configuration file (\*.ini file).</span>

<span class="sd">    Attributes:</span>
<span class="sd">        bin_dir: Required. Executable binary file path.</span>
<span class="sd">        ws: Derived from inputs. Workspace directories, see also CreateWorkspace.</span>
<span class="sd">        dem: Required. Input dem of study area. Be caution! DEM file should have one cell buffer</span>
<span class="sd">             of the desired extent, e.g., watershed boundary.</span>
<span class="sd">             If flag_PreProcess is set to False, dem can be None.</span>
<span class="sd">        mpi_dir: Optional. MPI binary path. If it has been exported to the environmental path,</span>
<span class="sd">                 set as None.</span>
<span class="sd">        hostfile: Optional. The hostfile is a text file that contains the names of hosts,</span>
<span class="sd">                  the number of available slots on each host, set to None if not stated.</span>
<span class="sd">        outlet: Optional. Watershed outlet as ESRI shapefile. Be caution! The outlet point should</span>
<span class="sd">                locate at least one cell inner the DEM boundary. If outlet is None, the maximum</span>
<span class="sd">                of Contributing Area will be identified as outlet.</span>
<span class="sd">        valley: Optional. Vally source as raster file. If not provided, set None.</span>
<span class="sd">        ridge: Optional. Ridge source as raster file. If not provided, set None.</span>
<span class="sd">        regional_attr: Regional topographic attributes, decrease from ridge to valley, range from</span>
<span class="sd">                       1 to 0, e.g., RPI (Relative Position Index, Skidmore, 1990)</span>
<span class="sd">        flag_preprocess: Preprocess for terrain attributes? True is default, if false, topographic</span>
<span class="sd">                         attributes used for fuzzy inference must be existed in &#39;Params&#39; dir.</span>
<span class="sd">        flag_selecttyploc: Select typical locations automatically? True is default, if false,</span>
<span class="sd">                           typical locations of each slope position must be existed.</span>
<span class="sd">        flag_auto_typlocparams: Automatically determine the parameters for typical locations?</span>
<span class="sd">                                True is default, if false, the script will find these parameters</span>
<span class="sd">                                from the \*.ini configuration file, and/or the XXXExtConfig.dat file</span>
<span class="sd">                                in &#39;Config&#39; directory.</span>
<span class="sd">                                Exception will be raised if all tries failed.</span>
<span class="sd">        flag_fuzzyinference: Calculate fuzzy membership of each slope position? True is default.</span>
<span class="sd">        flag_auto_inferenceparams: Automatically determine the parameters for fuzzy inference?</span>
<span class="sd">                                   True is default, if false, the script will find these parameters</span>
<span class="sd">                                   from the \*.ini configuration file, and/or the XXXInfConfig.dat</span>
<span class="sd">                                   in &#39;Config&#39; directory.</span>
<span class="sd">                                   Exception will be raised if all tries failed.</span>
<span class="sd">        flag_log: Write runtime log information to files. True is default.</span>
<span class="sd">        selectedtopo: Topographic attributes used for AutoFuzSlpPos. The key is attribute name,</span>
<span class="sd">                      and value is full file path. See also topoparam.</span>
<span class="sd">        extractrange: Extract value ranges for each topographic attributes of each slope positions.</span>
<span class="sd">                      {SlpPosType: {regionalAttr: [minv, maxv], ...}}</span>
<span class="sd">        inferparam: A Directory to store fuzzy inference parameters, the basic format is:</span>
<span class="sd">                    {SlpPosType: {regionalAttr: [FMFShape, w1, r1, k1, w2, r2, k2], ...}}</span>
<span class="sd">    See Also:</span>
<span class="sd">        ``Nomenclature.CreateWorkspace``</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># B(1)      6	2	0.5	6	2	0.5</span>
    <span class="c1"># S(2)      6	2	0.5	1	0	1</span>
    <span class="c1"># Z(3)      1	0	1	6	2	0.5</span>
    <span class="n">_FMFTYPE</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;Z&#39;</span><span class="p">}</span>
    <span class="n">_FMFPARAM</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                 <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                 <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]}</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cfg_parser</span><span class="p">,</span> <span class="n">bin_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">proc_num</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">rawdem</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">root_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize an AutoFuzSlpPosConfig object</span>
<span class="sd">        Args:</span>
<span class="sd">            cfg_parser: ConfigParser object</span>
<span class="sd">            bin_dir: Executable binaries path</span>
<span class="sd">            proc_num: thread (or process) number used for MPI</span>
<span class="sd">            rawdem: DEM of study area</span>
<span class="sd">            root_dir: workspace path</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Part I Initialize attributes</span>
        <span class="c1"># 1.1. input parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cf</span> <span class="o">=</span> <span class="n">cfg_parser</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bin_dir</span> <span class="o">=</span> <span class="n">bin_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proc</span> <span class="o">=</span> <span class="n">proc_num</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root_dir</span> <span class="o">=</span> <span class="n">root_dir</span>

        <span class="c1"># 1.2. Required inputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dem</span> <span class="o">=</span> <span class="n">rawdem</span>

        <span class="c1"># 1.3. Executable Flags (Set default flags first)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flag_preprocess</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flag_selecttyploc</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flag_auto_typlocparams</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flag_fuzzyinference</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flag_auto_inferenceparams</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flag_log</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># 1.4. Optional inputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mpi_dir</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hostfile</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outlet</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valley</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ridge</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regional_attr</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># 1.5. Optional DTA related parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flow_model</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rpi_method</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dist_exp</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_move_dist</span> <span class="o">=</span> <span class="mi">50</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numthresh</span> <span class="o">=</span> <span class="mi">20</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">d8_stream_thresh</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">d8_down_method</span> <span class="o">=</span> <span class="s1">&#39;Surface&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">d8_stream_tag</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">d8_up_method</span> <span class="o">=</span> <span class="s1">&#39;Surface&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dinf_stream_thresh</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dinf_down_stat</span> <span class="o">=</span> <span class="s1">&#39;Average&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dinf_down_method</span> <span class="o">=</span> <span class="s1">&#39;Surface&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dinf_dist_down_wg</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">propthresh</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dinf_up_stat</span> <span class="o">=</span> <span class="s1">&#39;Average&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dinf_up_method</span> <span class="o">=</span> <span class="s1">&#39;Surface&#39;</span>

        <span class="c1"># 1.6. Slope position types, tags, typical location extract value ranges, and inference</span>
        <span class="c1">#      parameters.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slppostype</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>  <span class="c1"># From top to bottom on hillslope.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slppostag</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>  <span class="c1"># The same sequence with self.slppostype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selectedtopo</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1"># Topographic attributes used for AutoFuzSlpPos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extractrange</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param4typloc</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">infshape</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inferparam</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="c1"># 1.7. derived attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">topoparam</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slpposresult</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pretaudem</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">singleslpposconf</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="c1"># Part II Set default settings, if cfg_parser is None, the program still can be executed.</span>

        <span class="c1"># default slope position settings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slppostype</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rdg&#39;</span><span class="p">,</span> <span class="s1">&#39;shd&#39;</span><span class="p">,</span> <span class="s1">&#39;bks&#39;</span><span class="p">,</span> <span class="s1">&#39;fts&#39;</span><span class="p">,</span> <span class="s1">&#39;vly&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slppostag</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selectedtopolist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rpi&#39;</span><span class="p">,</span> <span class="s1">&#39;profc&#39;</span><span class="p">,</span> <span class="s1">&#39;slp&#39;</span><span class="p">,</span> <span class="s1">&#39;elev&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selectedtopo</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extractrange</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rdg&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;rpi&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.99</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span>
                             <span class="s1">&#39;shd&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;rpi&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">]},</span>
                             <span class="s1">&#39;bks&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;rpi&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]},</span>
                             <span class="s1">&#39;fts&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;rpi&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]},</span>
                             <span class="s1">&#39;vly&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;rpi&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]}}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_DEFAULT_PARAM_TYPLOC</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">slppos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slppostype</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param4typloc</span><span class="p">[</span><span class="n">slppos</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_DEFAULT_PARAM_TYPLOC</span><span class="p">[:]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">infshape</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rdg&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;rpi&#39;</span><span class="p">:</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;profc&#39;</span><span class="p">:</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;slp&#39;</span><span class="p">:</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;elev&#39;</span><span class="p">:</span> <span class="s1">&#39;SN&#39;</span><span class="p">},</span>
                         <span class="s1">&#39;shd&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;rpi&#39;</span><span class="p">:</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;profc&#39;</span><span class="p">:</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;slp&#39;</span><span class="p">:</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;elev&#39;</span><span class="p">:</span> <span class="s1">&#39;N&#39;</span><span class="p">},</span>
                         <span class="s1">&#39;bks&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;rpi&#39;</span><span class="p">:</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;profc&#39;</span><span class="p">:</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;slp&#39;</span><span class="p">:</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;elev&#39;</span><span class="p">:</span> <span class="s1">&#39;N&#39;</span><span class="p">},</span>
                         <span class="s1">&#39;fts&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;rpi&#39;</span><span class="p">:</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;profc&#39;</span><span class="p">:</span> <span class="s1">&#39;ZB&#39;</span><span class="p">,</span> <span class="s1">&#39;slp&#39;</span><span class="p">:</span> <span class="s1">&#39;ZB&#39;</span><span class="p">,</span> <span class="s1">&#39;elev&#39;</span><span class="p">:</span> <span class="s1">&#39;N&#39;</span><span class="p">},</span>
                         <span class="s1">&#39;vly&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;rpi&#39;</span><span class="p">:</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;profc&#39;</span><span class="p">:</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;slp&#39;</span><span class="p">:</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;elev&#39;</span><span class="p">:</span> <span class="s1">&#39;N&#39;</span><span class="p">}}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dem</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_dir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">root_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dem</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpi_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">mpipath</span> <span class="o">=</span> <span class="n">FileClass</span><span class="o">.</span><span class="n">get_executable_fullpath</span><span class="p">(</span><span class="s1">&#39;mpiexec&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">mpi_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">mpipath</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpi_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Can not find mpiexec, make sure you have it installed!&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;You MUST select one of ini file or dem and bin!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_dir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="o">=</span> <span class="n">CreateWorkspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root_dir</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">LogNames</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="o">.</span><span class="n">log_dir</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">topoparam</span> <span class="o">=</span> <span class="n">TopoAttrNames</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">slpposresult</span> <span class="o">=</span> <span class="n">FuzSlpPosFiles</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pretaudem</span> <span class="o">=</span> <span class="n">PreProcessAttrNames</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="o">.</span><span class="n">pre_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">flow_model</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selectedtopolist</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selectedtopo</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">topoparam</span><span class="o">.</span><span class="n">get_attr_file</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">slppos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slppostype</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">singleslpposconf</span><span class="p">[</span><span class="n">slppos</span><span class="p">]</span> <span class="o">=</span> <span class="n">SingleSlpPosFiles</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">,</span> <span class="n">slppos</span><span class="p">)</span>

        <span class="c1"># Part III Parse the *.ini configuration file if existed</span>
        <span class="c1">#          Be careful, bin_dir, root_dir, proc_num, and rawdem related attributes</span>
        <span class="c1">#          that have already set MUST not be changed in the following procedures.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Parse and check validation of all available inputs</span>
            <span class="c1"># define the section names in the *.ini configuration file</span>
            <span class="n">_require</span> <span class="o">=</span> <span class="s1">&#39;REQUIRED&#39;</span>
            <span class="n">_flag</span> <span class="o">=</span> <span class="s1">&#39;EXECUTABLE_FLAGS&#39;</span>
            <span class="n">_optdta</span> <span class="o">=</span> <span class="s1">&#39;OPTIONAL_DTA&#39;</span>
            <span class="n">_opt</span> <span class="o">=</span> <span class="s1">&#39;OPTIONAL&#39;</span>
            <span class="n">_opttyploc</span> <span class="o">=</span> <span class="s1">&#39;OPTIONAL_TYPLOC&#39;</span>
            <span class="n">_optfuzinf</span> <span class="o">=</span> <span class="s1">&#39;OPTIONAL_FUZINF&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_required_section</span><span class="p">(</span><span class="n">_require</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_flag_section</span><span class="p">(</span><span class="n">_flag</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_optionaldta_section</span><span class="p">(</span><span class="n">_optdta</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_optional_section</span><span class="p">(</span><span class="n">_opt</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_optiontyploc_section</span><span class="p">(</span><span class="n">_opttyploc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_optionfuzinf_section</span><span class="p">(</span><span class="n">_optfuzinf</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="AutoFuzSlpPosConfig.check_file_available"><a class="viewcode-back" href="../../config.html#autofuzslppos.Config.AutoFuzSlpPosConfig.check_file_available">[docs]</a>    <span class="k">def</span> <span class="nf">check_file_available</span><span class="p">(</span><span class="n">in_f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check the input file is existed or not, and return None, if not.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">StringClass</span><span class="o">.</span><span class="n">string_match</span><span class="p">(</span><span class="n">in_f</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">in_f</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">or</span> <span class="n">in_f</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">FileClass</span><span class="o">.</span><span class="n">is_file_exists</span><span class="p">(</span><span class="n">in_f</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The </span><span class="si">%s</span><span class="s2"> is not existed or have no access permission!&quot;</span> <span class="o">%</span> <span class="n">in_f</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">in_f</span></div>

<div class="viewcode-block" id="AutoFuzSlpPosConfig.read_required_section"><a class="viewcode-back" href="../../config.html#autofuzslppos.Config.AutoFuzSlpPosConfig.read_required_section">[docs]</a>    <span class="k">def</span> <span class="nf">read_required_section</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_require</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;read and check required section&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">_require</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bin_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_require</span><span class="p">,</span> <span class="s1">&#39;exedir&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_dir</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="n">_require</span><span class="p">,</span> <span class="s1">&#39;rootdir&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">root_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_require</span><span class="p">,</span> <span class="s1">&#39;rootdir&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;Workspace must be defined!&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="o">=</span> <span class="n">CreateWorkspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root_dir</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">LogNames</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="o">.</span><span class="n">log_dir</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">topoparam</span> <span class="o">=</span> <span class="n">TopoAttrNames</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">slpposresult</span> <span class="o">=</span> <span class="n">FuzSlpPosFiles</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dem</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_require</span><span class="p">,</span> <span class="s1">&#39;rawdem&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dem</span> <span class="o">=</span> <span class="n">AutoFuzSlpPosConfig</span><span class="o">.</span><span class="n">check_file_available</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dem</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dem</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;DEM can not be None!&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;[REQUIRED] section MUST be existed in *.ini file.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bin_dir</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bin_dir</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">FileClass</span><span class="o">.</span><span class="n">get_executable_fullpath</span><span class="p">(</span><span class="s1">&#39;fuzzyslpposinference&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;exeDir is set to None, however the executable path are not &quot;</span>
                                   <span class="s2">&quot;set in environment path!&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutoFuzSlpPosConfig.read_flag_section"><a class="viewcode-back" href="../../config.html#autofuzslppos.Config.AutoFuzSlpPosConfig.read_flag_section">[docs]</a>    <span class="k">def</span> <span class="nf">read_flag_section</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_flag</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;read executable flags&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">_flag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flag_preprocess</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">getboolean</span><span class="p">(</span><span class="n">_flag</span><span class="p">,</span> <span class="s1">&#39;preprocess&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flag_selecttyploc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">getboolean</span><span class="p">(</span><span class="n">_flag</span><span class="p">,</span> <span class="s1">&#39;typlocselection&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flag_auto_typlocparams</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">getboolean</span><span class="p">(</span><span class="n">_flag</span><span class="p">,</span> <span class="s1">&#39;autotyplocparams&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flag_fuzzyinference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">getboolean</span><span class="p">(</span><span class="n">_flag</span><span class="p">,</span> <span class="s1">&#39;fuzzyinference&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flag_auto_inferenceparams</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">getboolean</span><span class="p">(</span><span class="n">_flag</span><span class="p">,</span> <span class="s1">&#39;autoinfparams&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flag_log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">getboolean</span><span class="p">(</span><span class="n">_flag</span><span class="p">,</span> <span class="s1">&#39;extlog&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutoFuzSlpPosConfig.read_optionaldta_section"><a class="viewcode-back" href="../../config.html#autofuzslppos.Config.AutoFuzSlpPosConfig.read_optionaldta_section">[docs]</a>    <span class="k">def</span> <span class="nf">read_optionaldta_section</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_optdta</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Optional parameters settings of digital terrain analysis for topographic attributes&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">_optdta</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flow_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">getint</span><span class="p">(</span><span class="n">_optdta</span><span class="p">,</span> <span class="s1">&#39;flowmodel&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rpi_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">getint</span><span class="p">(</span><span class="n">_optdta</span><span class="p">,</span> <span class="s1">&#39;rpimethod&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dist_exp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">getint</span><span class="p">(</span><span class="n">_optdta</span><span class="p">,</span> <span class="s1">&#39;distanceexponentforidw&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_move_dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">getfloat</span><span class="p">(</span><span class="n">_optdta</span><span class="p">,</span> <span class="s1">&#39;maxmovedist&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numthresh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">getint</span><span class="p">(</span><span class="n">_optdta</span><span class="p">,</span> <span class="s1">&#39;numthresh&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">d8_stream_thresh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">getint</span><span class="p">(</span><span class="n">_optdta</span><span class="p">,</span> <span class="s1">&#39;d8streamthreshold&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">d8_down_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_optdta</span><span class="p">,</span> <span class="s1">&#39;d8downmethod&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">d8_stream_tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">getint</span><span class="p">(</span><span class="n">_optdta</span><span class="p">,</span> <span class="s1">&#39;d8streamtag&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">d8_up_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_optdta</span><span class="p">,</span> <span class="s1">&#39;d8upmethod&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dinf_stream_thresh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">getint</span><span class="p">(</span><span class="n">_optdta</span><span class="p">,</span> <span class="s1">&#39;dinfstreamthreshold&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dinf_down_stat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_optdta</span><span class="p">,</span> <span class="s1">&#39;dinfdownstat&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dinf_down_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_optdta</span><span class="p">,</span> <span class="s1">&#39;dinfdownmethod&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dinf_dist_down_wg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_optdta</span><span class="p">,</span> <span class="s1">&#39;dinfdistdownwg&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">propthresh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">getfloat</span><span class="p">(</span><span class="n">_optdta</span><span class="p">,</span> <span class="s1">&#39;propthresh&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dinf_up_stat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_optdta</span><span class="p">,</span> <span class="s1">&#39;dinfupstat&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dinf_up_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_optdta</span><span class="p">,</span> <span class="s1">&#39;dinfupmethod&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flow_model</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flow_model</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpi_method</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rpi_method</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist_exp</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dist_exp</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_move_dist</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max_move_dist</span> <span class="o">=</span> <span class="mi">50</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">numthresh</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">numthresh</span> <span class="o">=</span> <span class="mi">20</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">d8_stream_thresh</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">d8_stream_thresh</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">distance_method</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Horizontal&#39;</span><span class="p">,</span> <span class="s1">&#39;Vertical&#39;</span><span class="p">,</span> <span class="s1">&#39;Pythagoras&#39;</span><span class="p">,</span> <span class="s1">&#39;Surface&#39;</span><span class="p">]</span>
        <span class="n">stat_method</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="s1">&#39;Maximum&#39;</span><span class="p">,</span> <span class="s1">&#39;Minimum&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">StringClass</span><span class="o">.</span><span class="n">string_in_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">d8_down_method</span><span class="p">,</span> <span class="n">distance_method</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">d8_down_method</span> <span class="o">=</span> <span class="s1">&#39;Surface&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">d8_stream_tag</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">d8_stream_tag</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">StringClass</span><span class="o">.</span><span class="n">string_in_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">d8_up_method</span><span class="p">,</span> <span class="n">distance_method</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">d8_up_method</span> <span class="o">=</span> <span class="s1">&#39;Surface&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dinf_stream_thresh</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dinf_stream_thresh</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">StringClass</span><span class="o">.</span><span class="n">string_in_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dinf_down_stat</span><span class="p">,</span> <span class="n">stat_method</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dinf_down_stat</span> <span class="o">=</span> <span class="s1">&#39;Average&#39;</span>
        <span class="k">if</span> <span class="n">StringClass</span><span class="o">.</span><span class="n">string_in_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dinf_down_method</span><span class="p">,</span> <span class="n">distance_method</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dinf_down_method</span> <span class="o">=</span> <span class="s1">&#39;Surface&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dinf_dist_down_wg</span> <span class="o">=</span> <span class="n">AutoFuzSlpPosConfig</span><span class="o">.</span><span class="n">check_file_available</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dinf_dist_down_wg</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">propthresh</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">propthresh</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">StringClass</span><span class="o">.</span><span class="n">string_in_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dinf_up_stat</span><span class="p">,</span> <span class="n">stat_method</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dinf_up_stat</span> <span class="o">=</span> <span class="s1">&#39;Average&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">StringClass</span><span class="o">.</span><span class="n">string_in_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dinf_up_method</span><span class="p">,</span> <span class="n">distance_method</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dinf_up_method</span> <span class="o">=</span> <span class="s1">&#39;Surface&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pretaudem</span> <span class="o">=</span> <span class="n">PreProcessAttrNames</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="o">.</span><span class="n">pre_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">flow_model</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutoFuzSlpPosConfig.read_optional_section"><a class="viewcode-back" href="../../config.html#autofuzslppos.Config.AutoFuzSlpPosConfig.read_optional_section">[docs]</a>    <span class="k">def</span> <span class="nf">read_optional_section</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_opt</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;read and check OPTIONAL inputs.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">_opt</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mpi_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_opt</span><span class="p">,</span> <span class="s1">&#39;mpiexedir&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hostfile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_opt</span><span class="p">,</span> <span class="s1">&#39;hostfile&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outlet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_opt</span><span class="p">,</span> <span class="s1">&#39;outlet&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valley</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_opt</span><span class="p">,</span> <span class="s1">&#39;vlysrc&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ridge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_opt</span><span class="p">,</span> <span class="s1">&#39;rdgsrc&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regional_attr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_opt</span><span class="p">,</span> <span class="s1">&#39;regionalattr&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">proc</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">proc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="n">_opt</span><span class="p">,</span> <span class="s1">&#39;inputproc&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">proc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">getint</span><span class="p">(</span><span class="n">_opt</span><span class="p">,</span> <span class="s1">&#39;inputproc&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">proc</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="c1"># if mpi directory is not set</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpi_dir</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">StringClass</span><span class="o">.</span><span class="n">string_match</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mpi_dir</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">)</span> \
            <span class="ow">or</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mpi_dir</span><span class="p">):</span>
            <span class="n">mpipath</span> <span class="o">=</span> <span class="n">FileClass</span><span class="o">.</span><span class="n">get_executable_fullpath</span><span class="p">(</span><span class="s1">&#39;mpiexec&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mpi_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">mpipath</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpi_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Can not find mpiexec!&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hostfile</span> <span class="o">=</span> <span class="n">AutoFuzSlpPosConfig</span><span class="o">.</span><span class="n">check_file_available</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hostfile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outlet</span> <span class="o">=</span> <span class="n">AutoFuzSlpPosConfig</span><span class="o">.</span><span class="n">check_file_available</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outlet</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valley</span> <span class="o">=</span> <span class="n">AutoFuzSlpPosConfig</span><span class="o">.</span><span class="n">check_file_available</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valley</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ridge</span> <span class="o">=</span> <span class="n">AutoFuzSlpPosConfig</span><span class="o">.</span><span class="n">check_file_available</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ridge</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regional_attr</span> <span class="o">=</span> <span class="n">AutoFuzSlpPosConfig</span><span class="o">.</span><span class="n">check_file_available</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regional_attr</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">topoparam</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">topoparam</span> <span class="o">=</span> <span class="n">TopoAttrNames</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">regional_attr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">topoparam</span><span class="o">.</span><span class="n">add_user_defined_attribute</span><span class="p">(</span><span class="s1">&#39;rpi&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">regional_attr</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutoFuzSlpPosConfig.read_optiontyploc_section"><a class="viewcode-back" href="../../config.html#autofuzslppos.Config.AutoFuzSlpPosConfig.read_optiontyploc_section">[docs]</a>    <span class="k">def</span> <span class="nf">read_optiontyploc_section</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_opttyploc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Optional parameter-settings for Typical Locations selection&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">_opttyploc</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="c1"># handling slope position types and tags</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="n">_opttyploc</span><span class="p">,</span> <span class="s1">&#39;slopepositiontypes&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">slppostype</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="n">typstrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_opttyploc</span><span class="p">,</span> <span class="s1">&#39;slopepositiontypes&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">slppostype</span> <span class="o">=</span> <span class="n">StringClass</span><span class="o">.</span><span class="n">split_string</span><span class="p">(</span><span class="n">typstrs</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># five slope position system will be adapted.</span>
            <span class="k">pass</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="n">_opttyploc</span><span class="p">,</span> <span class="s1">&#39;slopepositiontags&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">slppostag</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="n">tagstrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_opttyploc</span><span class="p">,</span> <span class="s1">&#39;slopepositiontags&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">slppostag</span> <span class="o">=</span> <span class="n">StringClass</span><span class="o">.</span><span class="n">extract_numeric_values_from_string</span><span class="p">(</span><span class="n">tagstrs</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slppostag</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slppostype</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;The input number of slope position types and &quot;</span>
                                   <span class="s2">&quot;tags are not the same!&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">slppostag</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slppostype</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">slppostag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slppostype</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">singleslpposconf</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span> <span class="o">=</span> <span class="n">SingleSlpPosFiles</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">,</span> <span class="n">typ</span><span class="p">)</span>
        <span class="c1"># handling selected topographic attributes</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="n">_opttyploc</span><span class="p">,</span> <span class="s1">&#39;terrainattrdict&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selectedtopolist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selectedtopo</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="n">terrain_attr_dict_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_opttyploc</span><span class="p">,</span> <span class="s1">&#39;terrainattrdict&#39;</span><span class="p">)</span>
            <span class="n">attrpath_strs</span> <span class="o">=</span> <span class="n">StringClass</span><span class="o">.</span><span class="n">split_string</span><span class="p">(</span><span class="n">terrain_attr_dict_str</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">singattr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">attrpath_strs</span><span class="p">):</span>
                <span class="n">ap</span> <span class="o">=</span> <span class="n">StringClass</span><span class="o">.</span><span class="n">split_string</span><span class="p">(</span><span class="n">singattr</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
                <span class="n">attrname</span> <span class="o">=</span> <span class="n">ap</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">StringClass</span><span class="o">.</span><span class="n">string_match</span><span class="p">(</span><span class="n">attrname</span><span class="p">,</span> <span class="s1">&#39;rpi&#39;</span><span class="p">):</span>
                    <span class="n">attrname</span> <span class="o">=</span> <span class="s1">&#39;rpi&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selectedtopolist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attrname</span><span class="p">)</span>
                <span class="n">attrpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">topoparam</span><span class="o">.</span><span class="n">get_attr_file</span><span class="p">(</span><span class="n">attrname</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">attrpath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">selectedtopo</span><span class="p">[</span><span class="n">attrname</span><span class="p">]</span> <span class="o">=</span> <span class="n">attrpath</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># this should be user-defined attribute, and should has a valid file path</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ap</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;User defined topographic attribute (</span><span class="si">%s</span><span class="s2">) MUST have &quot;</span>
                                           <span class="s2">&quot;an existed file path!&quot;</span> <span class="o">%</span> <span class="n">singattr</span><span class="p">)</span>
                    <span class="n">attrp</span> <span class="o">=</span> <span class="n">AutoFuzSlpPosConfig</span><span class="o">.</span><span class="n">check_file_available</span><span class="p">(</span><span class="n">ap</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">attrp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;User defined topographic attribute (</span><span class="si">%s</span><span class="s2">) MUST have &quot;</span>
                                           <span class="s2">&quot;an existed file path!&quot;</span> <span class="o">%</span> <span class="n">singattr</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">selectedtopo</span><span class="p">[</span><span class="n">attrname</span><span class="p">]</span> <span class="o">=</span> <span class="n">attrp</span>
                    <span class="n">is_regional</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># the first one is regional attribute</span>
                        <span class="n">is_regional</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">topoparam</span><span class="o">.</span><span class="n">add_user_defined_attribute</span><span class="p">(</span><span class="n">attrname</span><span class="p">,</span> <span class="n">attrp</span><span class="p">,</span> <span class="n">is_regional</span><span class="p">)</span>
        <span class="c1"># handling several parameters used in extracting typical location</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="n">_opttyploc</span><span class="p">,</span> <span class="s1">&#39;typlocextractparam&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param4typloc</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="n">base_param_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_opttyploc</span><span class="p">,</span> <span class="s1">&#39;typlocextractparam&#39;</span><span class="p">)</span>
            <span class="n">base_param_floats</span> <span class="o">=</span> <span class="n">StringClass</span><span class="o">.</span><span class="n">extract_numeric_values_from_string</span><span class="p">(</span><span class="n">base_param_str</span><span class="p">)</span>
            <span class="n">defnum</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_DEFAULT_PARAM_TYPLOC</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">base_param_floats</span><span class="p">)</span> <span class="o">==</span> <span class="n">defnum</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">slppos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slppostype</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">param4typloc</span><span class="p">[</span><span class="n">slppos</span><span class="p">]</span> <span class="o">=</span> <span class="n">base_param_floats</span><span class="p">[:]</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">base_param_floats</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slppostype</span><span class="p">)</span> <span class="o">*</span> <span class="n">defnum</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">slppos</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slppostype</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">param4typloc</span><span class="p">[</span><span class="n">slppos</span><span class="p">]</span> <span class="o">=</span> <span class="n">base_param_floats</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">defnum</span><span class="p">:(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">defnum</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;TyplocExtractParam MUST has the number of &quot;</span>
                                   <span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> or </span><span class="si">%d</span><span class="s2">!&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">defnum</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slppostype</span><span class="p">)</span> <span class="o">*</span> <span class="n">defnum</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">slppos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slppostype</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">param4typloc</span><span class="p">[</span><span class="n">slppos</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_DEFAULT_PARAM_TYPLOC</span><span class="p">[:]</span>
        <span class="c1"># handling Pre-defined fuzzy membership function shapes of each terrain attribute</span>
        <span class="c1">#    for each slope position</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="n">_opttyploc</span><span class="p">,</span> <span class="s1">&#39;fuzinfdefault&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">infshape</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="n">fuz_inf_shp_strs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_opttyploc</span><span class="p">,</span> <span class="s1">&#39;fuzinfdefault&#39;</span><span class="p">)</span>
            <span class="c1"># inference shapes are separated by SIMICOLON bewteen slope positions</span>
            <span class="n">fuz_inf_shp_types</span> <span class="o">=</span> <span class="n">StringClass</span><span class="o">.</span><span class="n">split_string</span><span class="p">(</span><span class="n">fuz_inf_shp_strs</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fuz_inf_shp_types</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slppostype</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;FuzInfDefault (</span><span class="si">%s</span><span class="s2">) MUST be consistent with slope position types&quot;</span>
                                   <span class="s2">&quot; and separated by &#39;;&#39;!&quot;</span> <span class="o">%</span> <span class="n">fuz_inf_shp_strs</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">slppos</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slppostype</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">infshape</span><span class="p">[</span><span class="n">slppos</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                <span class="c1"># inference shapes are separated by COMMA bewteen topographic attributes</span>
                <span class="n">infshps</span> <span class="o">=</span> <span class="n">StringClass</span><span class="o">.</span><span class="n">split_string</span><span class="p">(</span><span class="n">fuz_inf_shp_types</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">infshps</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selectedtopolist</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;FuzInfDefault (</span><span class="si">%s</span><span class="s2">) for each slope position MUST have &quot;</span>
                                       <span class="s2">&quot;the same size with TerrainAttrDict&quot;</span> <span class="o">%</span> <span class="n">fuz_inf_shp_types</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">attrn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selectedtopolist</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">infshape</span><span class="p">[</span><span class="n">slppos</span><span class="p">][</span><span class="n">attrn</span><span class="p">]</span> <span class="o">=</span> <span class="n">infshps</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slppostype</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">5</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Only the fuzzy membership function shapes of &quot;</span>
                                   <span class="s2">&quot;5 slope position system are built-in. For other &quot;</span>
                                   <span class="s2">&quot;classification system, please set as input!&quot;</span><span class="p">)</span>
        <span class="c1"># handling value ranges of terrain attributes for extracting prototypes</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="n">_opttyploc</span><span class="p">,</span> <span class="s1">&#39;valueranges&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">extractrange</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="n">value_rng_strs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_opttyploc</span><span class="p">,</span> <span class="s1">&#39;valueranges&#39;</span><span class="p">)</span>
            <span class="n">value_rng_types</span> <span class="o">=</span> <span class="n">StringClass</span><span class="o">.</span><span class="n">split_string</span><span class="p">(</span><span class="n">value_rng_strs</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value_rng_types</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slppostype</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;ValueRanges (</span><span class="si">%s</span><span class="s2">) MUST be consistent with slope position types&quot;</span>
                                   <span class="s2">&quot; and separated by &#39;;&#39;!&quot;</span> <span class="o">%</span> <span class="n">value_rng_strs</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">slppos</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slppostype</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">extractrange</span><span class="p">[</span><span class="n">slppos</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                <span class="n">value_rngs</span> <span class="o">=</span> <span class="n">StringClass</span><span class="o">.</span><span class="n">extract_numeric_values_from_string</span><span class="p">(</span><span class="n">value_rng_types</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value_rngs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">value_rngs</span><span class="p">)</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Each item of ValueRanges MUST contains three elements,&quot;</span>
                                       <span class="s2">&quot;i.e., Attributes No., Min, Max! Please check item: &quot;</span>
                                       <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> for </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">value_rng_types</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">slppos</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">value_rngs</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)):</span>
                    <span class="n">attridx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value_rngs</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="mi">3</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span>
                    <span class="n">attrname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selectedtopolist</span><span class="p">[</span><span class="n">attridx</span><span class="p">]</span>
                    <span class="n">min_v</span> <span class="o">=</span> <span class="n">value_rngs</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="n">max_v</span> <span class="o">=</span> <span class="n">value_rngs</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">extractrange</span><span class="p">[</span><span class="n">slppos</span><span class="p">][</span><span class="n">attrname</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">min_v</span><span class="p">,</span> <span class="n">max_v</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slppostype</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">5</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Only the extract value ranges of &quot;</span>
                                   <span class="s2">&quot;5 slope position system are built-in. For other &quot;</span>
                                   <span class="s2">&quot;classification system, please set as input!&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutoFuzSlpPosConfig.read_optionfuzinf_section"><a class="viewcode-back" href="../../config.html#autofuzslppos.Config.AutoFuzSlpPosConfig.read_optionfuzinf_section">[docs]</a>    <span class="k">def</span> <span class="nf">read_optionfuzinf_section</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_optfuzinf</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Optional parameter-settings for Fuzzy slope position inference.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">_optfuzinf</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="n">_optfuzinf</span><span class="p">,</span> <span class="s1">&#39;inferparams&#39;</span><span class="p">):</span>
            <span class="n">fuzinf_strs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_optfuzinf</span><span class="p">,</span> <span class="s1">&#39;inferparams&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">StringClass</span><span class="o">.</span><span class="n">string_match</span><span class="p">(</span><span class="n">fuzinf_strs</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inferparam</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="n">fuzinf_types</span> <span class="o">=</span> <span class="n">StringClass</span><span class="o">.</span><span class="n">split_string</span><span class="p">(</span><span class="n">fuzinf_strs</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fuzinf_types</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slppostype</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;InferParams (</span><span class="si">%s</span><span class="s2">) MUST be consistent with slope position types&quot;</span>
                                   <span class="s2">&quot; and separated by &#39;;&#39;!&quot;</span> <span class="o">%</span> <span class="n">fuzinf_strs</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">slppos</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slppostype</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inferparam</span><span class="p">[</span><span class="n">slppos</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                <span class="n">infparams</span> <span class="o">=</span> <span class="n">StringClass</span><span class="o">.</span><span class="n">extract_numeric_values_from_string</span><span class="p">(</span><span class="n">fuzinf_types</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">infparams</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Each item of InferParams MUST contains four elements,&quot;</span>
                                       <span class="s2">&quot;i.e., Attribute No., FMF No., w1, w2! Please check item: &quot;</span>
                                       <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> for </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fuzinf_types</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">slppos</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">infparams</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)):</span>
                    <span class="n">attridx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">infparams</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="mi">4</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span>
                    <span class="n">attrname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selectedtopolist</span><span class="p">[</span><span class="n">attridx</span><span class="p">]</span>
                    <span class="n">fmf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_FMFTYPE</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">infparams</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])]</span>
                    <span class="n">curinfparam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_FMFPARAM</span><span class="p">[</span><span class="n">fmf</span><span class="p">][:]</span>
                    <span class="n">curinfparam</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">infparams</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span>  <span class="c1"># w1</span>
                    <span class="n">curinfparam</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">infparams</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># w2</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">inferparam</span><span class="p">[</span><span class="n">slppos</span><span class="p">][</span><span class="n">attrname</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">fmf</span><span class="p">]</span> <span class="o">+</span> <span class="n">curinfparam</span></div></div>


<div class="viewcode-block" id="get_input_cfgs"><a class="viewcode-back" href="../../config.html#autofuzslppos.Config.get_input_cfgs">[docs]</a><span class="k">def</span> <span class="nf">get_input_cfgs</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Get model configuration arguments.</span>

<span class="sd">    Returns:</span>
<span class="sd">            InputArgs object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Read AutoFuzSlpPos configurations.&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-ini&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Full path of configuration file.&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-bin&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Path of executable programs, which will override&quot;</span>
                                     <span class="s2">&quot;exeDir in *.ini file.&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-proc&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Number of processor for parallel computing, &quot;</span>
                                      <span class="s2">&quot;which will override inputProc in *.ini file.&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-dem&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;DEM of study area.&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-root&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Workspace to store results, which will override &quot;</span>
                                      <span class="s2">&quot;rootDir in *.ini file.&quot;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="n">ini_file</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">ini</span>
    <span class="n">bin_dir</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">bin</span>
    <span class="n">input_proc</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">proc</span>
    <span class="n">rawdem</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">dem</span>
    <span class="n">root_dir</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">root</span>
    <span class="k">if</span> <span class="n">input_proc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="n">StringClass</span><span class="o">.</span><span class="n">extract_numeric_values_from_string</span><span class="p">(</span><span class="n">input_proc</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xx</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;-proc MUST be one integer number!&quot;</span><span class="p">)</span>
        <span class="n">input_proc</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">input_proc</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">FileClass</span><span class="o">.</span><span class="n">is_file_exists</span><span class="p">(</span><span class="n">ini_file</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">FileClass</span><span class="o">.</span><span class="n">is_file_exists</span><span class="p">(</span><span class="n">rawdem</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">bin_dir</span><span class="p">):</span>
            <span class="c1"># In this scenario, the script can be executed by default setting, i.e., the *.ini</span>
            <span class="c1"># file is not required.</span>
            <span class="n">cf</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">input_proc</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">input_proc</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;*.ini file MUST be provided when &#39;-dem&#39;, &#39;-bin&#39;, &quot;</span>
                               <span class="s2">&quot;and &#39;-root&#39; are not provided!&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cf</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="p">()</span>
        <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">ini_file</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">AutoFuzSlpPosConfig</span><span class="p">(</span><span class="n">cf</span><span class="p">,</span> <span class="n">bin_dir</span><span class="p">,</span> <span class="n">input_proc</span><span class="p">,</span> <span class="n">rawdem</span><span class="p">,</span> <span class="n">root_dir</span><span class="p">)</span></div>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">fuzslppos_cfg</span> <span class="o">=</span> <span class="n">get_input_cfgs</span><span class="p">()</span>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2019 Lreis, IGSNRR, CAS.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.1.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>